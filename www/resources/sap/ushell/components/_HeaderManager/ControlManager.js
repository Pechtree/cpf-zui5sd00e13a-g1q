// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/EventHub","sap/ui/core/IconPool","sap/ushell/Config","sap/ushell/renderers/fiori2/AccessKeysHandler","sap/ushell/resources","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/ushell/ui/footerbar/ContactSupportButton","sap/ushell/ui/footerbar/EndUserFeedback","sap/ushell/ui/shell/ShellHeadItem","sap/ushell/utils","sap/ui/core/CustomData","sap/ushell/ui/shell/ShellNavigationMenu"],function(E,I,C,A,r,a,b,c,S,u,d,e){"use strict";var f=[];var D=[];var g={SHELL_NAV_MENU_ONLY:0,ALL_MY_APPS_ONLY:1,SHELL_NAV_MENU:2,ALL_MY_APPS:3};function i(x,H,y){f.push(k(x));f.push(m(H));f.push(s(H,y));if(C.last("/core/shell/enableFiori3")){f.push(n(y));}else{f.push(o(y));}if(C.last("/core/shell/model/enableNotifications")){f.push(q(y));}if(x.moveEditHomePageActionToShellHeader){f.push(l());}if(x.moveAppFinderActionToShellHeader){f.push(t(x,H));}if(x.moveUserSettingsActionToShellHeader){f.push(j(H));}if(x.moveContactSupportActionToShellHeader){f.push(v());}if(x.moveGiveFeedbackActionToShellHeader){f.push(w());}D.push(E.once("CoreResourcesComplementLoaded").do(function(){_(x,y,H);}.bind(this)));}function h(){f.forEach(function(x){var y=sap.ui.getCore().byId(x);if(y){if(y.destroyContent){y.destroyContent();}y.destroy();}});D.forEach(function(x){x.off();});f=[];D=[];}function _(x,y,z){sap.ui.require(["sap/m/StandardListItem","sap/ushell/ui/shell/NavigationMiniTile"],function(B,N){var M="shellNavigationMenu";var H=function(K,L){var O=L.getProperty("icon")||"sap-icon://circle-task-2",T=L.getProperty("title"),P=L.getProperty("subtitle"),Q=T,U=L.getProperty("intent");if(P){Q=Q+"\n"+P;}var V=(new B({type:"Active",title:T,description:P,tooltip:Q,icon:O,customData:[new d({key:"intent",value:U})],press:[z.handleNavigationMenuItemPress,z]})).addStyleClass("sapUshellNavigationMenuListItems");return V;};var R=function(K,L){var O=L.getProperty("icon"),T=L.getProperty("title"),P=L.getProperty("subtitle"),Q=L.getProperty("intent");return new N({title:T,subtitle:P,icon:O,intent:Q,press:function(){var U=this.getIntent();if(U&&U[0]==="#"){z.navigateFromShellApplicationNavigationMenu(U);}}});};var F=new e(M,{title:"{/application/title}",icon:"{/application/icon}",showTitle:{path:"/application/showNavMenuTitle"},showRelatedApps:x.appState!=="lean",items:{path:"/application/hierarchy",factory:H.bind(this)},miniTiles:{path:"/application/relatedApps",factory:R.bind(this)},visible:{path:"/ShellAppTitleState",formatter:function(K){return K===g.SHELL_NAV_MENU;}}});var G=sap.ui.getCore().byId("shell-header");F.setModel(G.getModel());var J=sap.ui.getCore().byId("shellAppTitle");if(J){J.setNavigationMenu(F);}f.push(M);return M;}.bind(this));}function j(x){var y="userSettingsBtn";var U=sap.ui.getCore().byId(y);var z=function(){jQuery.sap.measure.start("FLP:ElementsModel._attachPressToUserSettings","_attachPressToUserSettings","FLP");var F=sap.ui.getCore().byId(y);if(F){F.attachPress(x.handleUserSettingsPress);}jQuery.sap.measure.end("FLP:ElementsModel._attachPressToUserSettings");};if(!U){var B=new S({id:y,icon:"sap-icon://action-settings",tooltip:"{i18n>userSettings}",text:"{i18n>userSettings}"});B.data("isShellHeader",true);D.push(E.on("CenterViewPointContentRendered").do(z));}return y;}function k(x){var y="homeBtn";var H=new S({id:y,tooltip:"{i18n>homeBtn_tooltip}",ariaLabel:"{i18n>homeBtn_tooltip}",icon:I.getIconURI("home"),target:x.rootIntent?"#"+x.rootIntent:"#"});H.addCustomData(new a({key:"aria-disabled",value:"false",writeToDom:true}));H.addEventDelegate({onsapskipback:function(z){if(A.getAppKeysHandler()){z.preventDefault();A.bFocusOnShell=false;}},onsapskipforward:function(z){if(A.getAppKeysHandler()){z.preventDefault();A.bFocusOnShell=false;}}});return y;}function l(){var x="ActionModeBtn";var T=new S({id:x,icon:"sap-icon://edit",visible:false});T.data("isShellHeader",true);if(C.last("/core/extension/enableHelp")){T.addStyleClass("help-id-openCatalogActionItem");}return x;}function m(x){var B=sap.ui.getCore().getConfiguration().getRTL()?"feeder-arrow":"nav-back";var y=new S({id:"backBtn",tooltip:"{i18n>backBtn_tooltip}",ariaLabel:"{i18n>backBtn_tooltip}",icon:I.getIconURI(B),press:x.pressNavBackButton.bind(x)});return y.getId();}function n(x){var y="meAreaHeaderButton";var M=new S({id:y,icon:"{/userImage/personPlaceHolder}",ariaLabel:"{i18n>MeAreaToggleButtonAria}",tooltip:sap.ushell.Container.getUser().getFullName(),press:function(){E.emit("showMeArea",Date.now());}});M.addEventDelegate({onsapskipforward:function(z){sap.ushell.renderers.fiori2.AccessKeysHandler.bForwardNavigation=true;z.preventDefault();window.document.getElementById("sapUshellHeaderAccessibilityHelper").focus();}});M.setModel(x);return y;}function o(x){var y="meAreaHeaderButton";var M=new S({id:y,icon:"{/userImage/personPlaceHolder}",visible:true,enabled:false});M.addStyleClass("sapUshellPlaceHolders");M.setModel(x);return y;}function p(B){B.applySettings({floatingNumber:{parts:["/notificationsCount"],formatter:function(x){var y=this.getDomRef(),z="";if(y){if(x>0){z=r.i18n.getText("NotificationToggleButtonCollapsed",x);}else{z=r.i18n.getText("NotificationToggleButtonCollapsedNoNotifications");}y.setAttribute("aria-label",z);}return x;}}},true,true);}function q(x){var y="NotificationsCountButton";var z=C.last("/core/shell/enableFiori3")===true?"bell":"ui-notifications";var N=new S({id:y,icon:sap.ui.core.IconPool.getIconURI(z),text:"{i18n>notificationsBtn_title}",visible:true,enabled:false});if(C.last("/core/shell/enableFiori3")!==true){N.addStyleClass("sapUshellPlaceHolders");}N.setModel(x);N.setModel(r.i18nModel,"i18n");p(N);return y;}function s(x,y){var z=new S({id:"endItemsOverflowBtn",tooltip:"{i18n>shellHeaderOverflowBtn_tooltip}",ariaLabel:"{i18n>shellHeaderOverflowBtn_tooltip}",icon:"sap-icon://overflow",press:[x.pressEndItemsOverflow,x],visible:true});if(C.last("/core/shell/enableFiori3")){p(z);z.setModel(y);}return z.getId();}function t(x,y){var z="openCatalogBtn";var O=new S({id:z,text:"{i18n>open_appFinderBtn}",tooltip:"{i18n>open_appFinderBtn}",icon:"sap-icon://sys-find",visible:!x.disableAppFinder,press:y.handleAppFinderPress});O.data("isShellHeader",true);if(C.last("/core/extension/enableHelp")){O.addStyleClass("help-id-openCatalogActionItem");}return z;}function v(){var B="ContactSupportBtn",x=sap.ui.getCore().byId(B);if(!x){var T=new b("tempContactSupportBtn",{visible:true});var y=T.getIcon();var z=T.getText();var F=new S({id:B,icon:y,tooltip:z,text:z,press:function(){T.firePress();}});F.data("isShellHeader",true);}return B;}function w(){var B="EndUserFeedbackBtn",x=sap.ui.getCore().byId(B);if(!x){var T=new c("EndUserFeedbackHandlerBtn",{});var y=T.getIcon();var z=T.getText();var F=new S({id:B,icon:y,tooltip:z,text:z,visible:false});F.data("isShellHeader",true);}return B;}return{init:i,destroy:h,_createOverflowButton:s};});
